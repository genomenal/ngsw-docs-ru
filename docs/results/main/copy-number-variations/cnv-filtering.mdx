---
sidebar_position: 3
sidebar_label: Поиск вариаций
---

# Поиск вариаций

Нужные вариации числа копий можно найти путём фильтрации. Параметры фильтрации находятся над таблицей:

<p align="center">
<img src={require('/img/vv/cnvv_filtering.png').default} width="900"/>
</p>

:::note На заметку
Фильтрация таблицы сохраняется при выходе со страницы CNV Viewer.
:::

### 1. Log2FC пороги {#log2fc-threshold}

Фильтр вариаций по строгости, а именно порогам log2FC - логарифмического соотношения выявленного числа копий к
нормальному числу копий. Возможные значения этого фильтра зависят от хромосомного пола образца, определяемого
CNVkit на основе относительного числа копий аутосом и половых хромосом.

Если хромосомный пол образца определён как **мужской (XY)** или если пол определить не удалось,
то возможными значениями фильтрации будут:
- Del: ≤-1, Dup: ≥0.58 (chrX: ≥1, chrY: ≥1) (XY)
- Del: ≤-0.9 (chrX: ≤-3.8, chrY: ≤-3.8), Dup: ≥0.55 (chrX: ≥0.94, chrY: ≥0.94) (XY)
- Del: ≤-0.8 (chrX: ≤-2.74, chrY: ≤-2.74), Dup: ≥0.51 (chrX: ≥0.88, chrY: ≥0.88) (XY)
- **Del: ≤-0.7 (chrX: ≤-2.11, chrY: ≤-2.11), Dup: ≥0.46 (chrX: ≥0.82, chrY: ≥0.82) (XY)** - значение по умолчанию
- Del: ≤-0.6 (chrX: ≤-1.64, chrY: ≤-1.64), Dup: ≥0.42 (chrX: ≥0.74, chrY: ≥0.74) (XY)
- Del: ≤-0.5 (chrX: ≤-1.27, chrY: ≤-1.27), Dup: ≥0.37 (chrX: ≥0.66, chrY: ≥0.66) (XY)
- Del: ≤-0.4 (chrX: ≤-0.95, chrY: ≤-0.95), Dup: ≥0.31 (chrX: ≥0.56, chrY: ≥0.56) (XY)
- Del: ≤-0.3 (chrX: ≤-0.67, chrY: ≤-0.67), Dup: ≥0.24 (chrX: ≥0.45, chrY: ≥0.45) (XY)

Если хромосомный пол образца определён как **женский (XX)**, то возможными значениями фильтрации будут:
- Del: ≤-1 (chrX: ≤0), Dup: ≥0.58 (chrX: ≥1.58, chrY: ≥0) (XX)
- Del: ≤-0.9 (chrX: ≤0.1), Dup: ≥0.55 (chrX: ≥1.55, chrY: ≥-0.1) (XX)
- Del: ≤-0.8 (chrX: ≤0.2), Dup: ≥0.51 (chrX: ≥1.51, chrY: ≥-0.23) (XX)
- **Del: ≤-0.7 (chrX: ≤0.3), Dup: ≥0.46 (chrX: ≥1.46, chrY: ≥-0.37) (XX)** - значение по умолчанию
- Del: ≤-0.6 (chrX: ≤0.4), Dup: ≥0.42 (chrX: ≥1.42, chrY: ≥-0.55) (XX)
- Del: ≤-0.5 (chrX: ≤0.5), Dup: ≥0.37 (chrX: ≥1.37, chrY: ≥-0.77) (XX)
- Del: ≤-0.4 (chrX: ≤0.6), Dup: ≥0.31 (chrX: ≥1.31, chrY: ≥-1.04) (XX)
- Del: ≤-0.3 (chrX: ≤0.7), Dup: ≥0.24 (chrX: ≥1.24, chrY: ≥-1.41) (XX)

**Алгоритм фильтрации**:
- Нажмите на окно фильтрации;
- Из появившегося списка выберите нужную опцию фильтрации либо введите интересующую вас опцию в окно
поиска и выберите из найденных.

Готово! Фильтр применен. То, какой выбран фильтр, можно увидеть в окошке:

<p align="center">
<img src={require('/img/vv/log2fc_value.png').default} width="200"/>
</p>

При сбросе всех фильтров для фильтра по порогам log2FC применяется значение по умолчанию.
Его можно изменить или очистить только в самом фильтре
(см. [далее](/results/main/copy-number-variations/cnv-filtering#reset-filtering)).

На примере условия по умолчанию для
XY: *Del: ≤-0.7 (chrX: ≤-2.11, chrY: ≤-2.11), Dup: ≥0.46 (chrX: ≥0.82, chrY: ≥0.82)*, разберём,
что означают эти условия фильтрации:
- Вариации числа копий на аутосомах с log2FC ≤ -0.7 принимаются за делеции. -0.7 - это порог log2FC по умолчанию,
ниже которого вызывается одна аутосома вместо двух в норме.
- Вариации числа копий на X- и Y-хромосомах с log2FC ≤ -2.11 принимаются за делеции.
- Вариации числа копий на аутосомах с log2FC ≥ 0.46 принимаются за дупликации. Порог для дупликации на
аутосоме рассчитывается по следующей формуле: *log2FC = log<sub>2</sub>((2+D)/2)*, где *D* - "количество"
копийности, которое "теряется" при log2FC=-0.7, а *2* - количество сестринских хроматид в аутосоме.
- Вариации числа копий на X- и Y-хромосомах с log2FC ≥ 0.82 принимаются за дупликации.
- Вариации, не удовлетворяющие порогам, т.е. вариации на аутосомах с -0.7 < log2FC < 0.46 и вариации на половых
хромосомах с -2.11 < log2FC < 0.82, не проходят фильтрацию и исключаются из таблицы CNV Viewer.

#### Расчёт порогов log2FC для делеций и дупликаций на аутосомах и половых хромосомах

Порог вызова одной копии вместо двух на аутосомах вычисляется следующим
образом: <i>T<sub>21</sub> = log<sub>2</sub>(C/2)</i>,
где <i>C</i> - количество вызванных копий.<br/>Дельта числа копий: <i>D = 2 – C = 2 – 2 × 2<sup>T<sub>21</sub></sup></i>.<br/>
Тогда соответствующий порог вызова трёх копий вместо двух на аутосомах вычисляется
так: <i>T<sub>23</sub> = log<sub>2</sub>((2+D)/2) = log<sub>2</sub>(2-2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Порог для вызова делеций на аутосомах:</b> <i>lo = T<sub>21</sub></i>.<br/>
<b>Порог для вызова дупликаций на аутосомах:</b> <i>hi = T<sub>23</sub></i>.<br/>
Для вычисления порога для вызова трёх копий вместо двух на Х-хромосоме нормализуем генотип XY, поделив его
на число копий, равное 1: <i>T<sub>23X</sub>= log<sub>2</sub>((2+D)/1) = log<sub>2</sub>(2+2-2×2<sup>T<sub>21</sub></sup>) = 1 + log<sub>2</sub>(2-2<sup>T<sub>21</sub></sup>) = 1 + T<sub>23</sub></i>.<br/>
<b>Вычисление порога для вызова дупликаций на X-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>X<sub>hi</sub> = 1 + T<sub>23</sub></i>;<br/>
- если есть Y-хромосома: <i>X<sub>hi</sub> = log<sub>2</sub>(3-2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
Порог для вызова одной копии вместо двух на Х-хромосоме: <i>T<sub>21X</sub> = log<sub>2</sub>((2-D)/1) = log<sub>2</sub>(2-2+2×2<sup>T<sub>21</sub></sup>) = 1 + T<sub>21</sub></i>.<br/>
Порог для вызова ни одной копии вместо одной на X-хромосоме: <i>T<sub>10X</sub> = log<sub>2</sub>((1-D)/1) = log<sub>2</sub>(1-2+2×2<sup>T<sub>21</sub></sup>) = log<sub>2</sub>(-1+2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Вычисление порога для вызова делеций на X-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>X<sub>lo</sub> = 1 + T<sub>21</sub></i>;<br/>
- если есть Y-хромосома: <i>X<sub>lo</sub> = log<sub>2</sub>(-1+2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
Порог для вызова одной копии вместо ни одной на Y-хромосоме в случае генотипа
XX: <i>T<sub>01</sub> = log<sub>2</sub>((0+D)/1) = log<sub>2</sub>(2-2×2<sup>T<sub>21</sub></sup>) = log<sub>2</sub>(2×(1-2<sup>T<sub>21</sub></sup>)) =  1 + log<sub>2</sub>(1-2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Вычисление порога для вызова дупликаций <i>Y<sub>hi</sub></i> и делеций <i>Y<sub>lo</sub></i> на Y-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>Y<sub>hi</sub> = 1 + log<sub>2</sub>(1-2<sup>T<sub>21</sub></sup>))</i>; <i>Y<sub>lo</sub> = -∞</i>;<br/>
- если есть Y-хромосома: <i>Y<sub>hi</sub> = X<sub>hi</sub></i>; <i>Y<sub>lo</sub> = X<sub>lo</sub></i>.

### 2. Регион chr:start-end {#region}

Фильтр вариаций по позиции. Для фильтрации введите позицию искомого геномного интервала: соответствующие хромосому и
стартовую и конечную позиции. Возможные варианты записи позиции:
- `chr1:161,190,824-161,193,921`
- `chr1:161190824-161193921`
- `chr1:161190824_161193921`
- `1:161190824-161193921`

Также можно фильтровать сразу по более, чем одному интервалу. Например, по `chr1:161190824-161193921, chrX:151110769-151113866`.

Результатом фильтрации будут строки с вариациями, чьи позиции пересекаются с введённым интервалом.

### 3. Панель генов {#gene-panel}

Фильтр вариаций по расположенным на их участках генам из панели.
Вы можете добавить панель генов <a href="/settings/gene-panels">на странице "Панели генов"</a>
или импортировать панель из библиотеки самых распространенных клинических панелей. Для импорта
нажмите на "<i>Импорт из библиотеки</i>":

<p align="center">
<img src={require('/img/vv/gene_panel.png').default} width="300"/>
</p>

В открывшейся форме выберите нужные панели, отметив их галочками:

<p align="center">
<img src={require('/img/gene_panels/checked_panels.png').default} width="600"/>
</p>

и нажмите на <img src={require('/img/gene_panels/import_btn.png').default} width="150"/>, чтобы добавить панель.

### 4. Ген {#gene}

Фильтр вариаций по расположенным на их участках транскриптам генов.
Транскрипт приведен в скобках рядом с официальным названием гена.
Можно отфильтровать вариации сразу по нескольким генам. Для этого отметьте галочками нужные гены
и кликните вне области заполнения значений:

<p align="center">
<img src={require('/img/vv/filter_by_gene.png').default} width="200"/>
</p>

Если для гена известно несколько транскриптов, в списке представлены все:

<p align="center">
<img src={require('/img/vv/many_transcripts.png').default} height="400"/>
</p>

### 5. HPO {#hpo}

Фильтр вариаций по расположенным на их участках генам, ассоциированным с терминами из словаря фенотипических аномалий
человека <a href="https://www.ebi.ac.uk/ols/ontologies/hp">Human Phenotype Ontology (HPO)</a>. Нажмите на окно
фильтрации по HPO, чтобы открыть форму поиска фенотипа. В форме в выпадающем списке представлены основные
фенотипические группы:

<p align="center">
<img src={require('/img/vv/hpo_search.png').default} width="800"/>
</p>

**Способы поиска и выбора фенотипа для фильтрации:**
- Поиск фенотипа непосредственно в выпадающем списке. С фенотипическими группами можно
взаимодействовать с помощью кнопок <img src={require('/img/vv/show.png').default} height="15"/> и <img src={require('/img/vv/hide.png').default} height="10"/> для
раскрытия и сворачивания списка терминов группы, соответственно:

<p align="center">
<img src={require('/img/vv/list_of_phenotypes.png').default} width="270"/>
</p>

Кроме того, фенотип можно найти через поиск по названию или идентификатору
из HPO. Например, при поиске заболевания “glioma” находятся несколько терминов:

<p align="center">
<img src={require('/img/vv/glioma_search.png').default} width="800"/>
</p>

Для выбора фенотипа для фильтрации нажмите на его строку. Можно выбрать как целую группу, так и
конкретный фенотип. Выбрав фенотип (например, "Glioma"), вы увидите его карточку:

<p align="center">
<img src={require('/img/vv/glioma_page.png').default} width="800"/>
</p>

Над карточкой фенотипа отмечены термины, выбранные для фильтрации. В скобочках указано количество
связанных с фенотипом генов. Нажав на фенотип, вы увидите его карточку. Фенотип можно удалить,
нажав на крестик <img src={require('/img/vv/delete_term_btn.png').default} width="15"/>:

<p align="center">
<img src={require('/img/vv/delete_term.png').default} width="500"/>
</p>

Слева в карточке фенотипа даны его определение и комментарий. В середине представлена иерархия фенотипа:
выше выбранного заболевания Glioma находятся его родительские термины
(те фенотипические группы, которые включают Glioma), а ниже - его дочерние
термины (заболевания, которые входят в группу Glioma).
Справа представлены гены, ассоциированные с данным фенотипом (в данном случае было найдено 45 генов).

- Поиск фенотипа по иерархии в карточке фенотипа: нажав на название родительского или дочернего
фенотипа, вы попадете на его страницу. Если фенотип ещё не выбран для фильтрации и
найдены ассоциированные с ним гены, то его можно выбрать для фильтрации вариаций,
нажав на кнопку <img src={require('/img/vv/add_term.png').default} width="150"/>.

- Поиск фенотипа в режиме мультиселекта: для этого переключите режим поиска,
нажав на <img src={require('/img/vv/switch_mode.png').default} width="120"/> в левом верхнем углу окна.
Вы увидите список основных фенотипические группы с флажками для выбора.
Фенотип можно найти через поиск по названию или идентификатору
из HPO. Например, при поиске заболевания “glioma” находятся несколько терминов:

<p align="center">
<img src={require('/img/vv/multiselect_hpo.png').default} width="800"/>
</p>

В режиме мультиселекта можно выбрать сразу несколько терминов в выпадающем списке.
Для выбора фенотипа для фильтрации нажмите на его строку:

<p align="center">
<img src={require('/img/vv/glioma_checked.png').default} width="400"/>
</p>

Чтобы закончить добавление фенотипа для фильтрации, кликните вне области выпадающего списка в
пределах формы поиска фенотипа. Наверху формы вы увидите термины, выбранные для фильтрации. В скобочках
указано количество связанных с фенотипом генов. Нажав на фенотип, вы увидите его карточку.
Фенотип можно удалить, нажав на крестик <img src={require('/img/vv/delete_term_btn.png').default} width="15"/>.

<p align="center">
<img src={require('/img/vv/multiselect_mode.png').default} width="800"/>
</p>

Чтобы ***отфильтровать вариации*** по генам, связанным с выбранным фенотипом,
нажмите <img src={require('/img/custom-annot/ok_btn.png').default} width="130"/>.
Выбранный фенотип можно увидеть во всплывающей подсказке, наведя курсор на поле фильтрации по HPO:

<p align="center">
<img src={require('/img/vv/chosen_phenotypes_cnvv.png').default} width="300"/>
</p>

Для того чтобы ***отменить фильтрацию*** по всем терминам, наведите курсор на окно фильтрации по HPO и
нажмите на появившийся крестик:

<p align="center">
<img src={require('/img/vv/cancel_hpo.png').default} width="150"/>
</p>

или нажмите на поле и отредактируйте свой выбор в форме поиска фенотипа.

### 6. Тип {#cnv-type}

Фильтр вариаций по типу изменения числа копий: LOSS - делеция, GAIN - дупликация.

### 7. CDS Перекрытие {#cds-overlap}

Фильтр вариаций по перекрытию с кодирующей последовательностью (CoDing Sequence; CDS):
- Overlapped CDS - вариация затрагивает кодирующую последовательность (процент перекрытия с CDS больше 0);
- Not overlapped CDS - вариация не затрагивает кодирующую последовательность (процент перекрытия с CDS равен 0).

### 8. Класс ACMG {#acmg-class}

Фильтр вариаций по патогенности, выставляемой соответственно категории, определённой
[AnnotSV](https://lbgi.fr/AnnotSV/Documentation/README.AnnotSV_latest.pdf):
* Pathogenic - Патогенная;
* Likely pathogenic - Вероятно патогенная;
* Uncertain significance conflict - Противоречивые интерпретации патогенности;
* Uncertain significance - Неопределенная значимость;
* Likely benign - Вероятно доброкачественная;
* Benign - Доброкачественная;
* Undefined - Нет интерпретации.

Можно отфильтровать вариации сразу по нескольким значениям патогенности. Для этого отметьте галочками нужные значения
и кликните вне области заполнения значений.

### 9. AF по когорте {#cohort-af}

Фильтр вариаций по частоте в когорте, состоящей из 188 нормальных образцов. Значения частот
есть только для герминальных вариаций числа копий, выявленных в образцах полногеномного секвенирования (WGS или
low-pass WGS), для нормализации которых использовались панели референсных образцов "*BGI WGS*" с размером бина
3000 или 5000 или "*BGI WGS v2*" с размером бина 3000. Фильтр отображается только в CNV Viewer с варициями числа
копий, выявленными в бинах.

Возможные значения:
- <0.05 или пусто;
- <0.02 или пусто;
- <0.01 или пусто;
- <0.005 или пусто;
- <0.0001 или пусто.

## Сброс фильтрации {#reset-filtering}

Для сброса ***всех*** примененных фильтров
нажмите на <img src={require('/img/vv/clear_filters.png').default} width="43"/>.
Сохранится только фильтрация по порогам log2FC по
умолчанию: *- Del: ≤-0.7 (chrX: ≤-2.11, chrY: ≤-2.11), Dup: ≥0.46 (chrX: ≥0.82, chrY: ≥0.82)*.

Для сброса ***отдельного фильтра***:
- Нажмите на окно фильтрации и затем на <img src={require('/img/vv/clear_option.png').default} width="100"/>.
- Для сброса фильтрации по региону наведите курсор на окно фильтрации и нажмите на появившийся крестик:

<p align="center">
<img src={require('/img/vv/clear_region.png').default} width="250"/>
</p>

- У фильтра по гену можно убрать одну из выбранных опций фильтрации. Для этого нажмите на окно фильтрации и
снимите галочку у опции.
- Для изменения выбора фенотипа HPO, по которому идёт фильтрация вариаций,
нажмите на поле фильтрации по HPO и отредактируйте свой выбор в форме
поиска фенотипа. Для сброса фильтрации по всем выбранным терминам наведите курсор на окно фильтрации по HPO и
нажмите на появившийся крестик:

<p align="center">
<img src={require('/img/vv/cancel_hpo.png').default} width="150"/>
</p>
